(self.webpackChunkwpshopify=self.webpackChunkwpshopify||[]).push([["ProductBuyButtonLeftInStock-public"],{"../../../../../devil/devilbox-new/data/www/wpshopify-components/components/products/product/buy-button/left-in-stock/index.jsx":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var o=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),r=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),s=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/common/css/index.jsx"),a={name:"kr195r-textNoticeCSS",styles:"text-align:center;margin:5px auto 2.4em auto;font-size:15px;padding:10px;color:red;width:100%;font-weight:normal;display:block;label:textNoticeCSS;"};function d(e){var t=e.quantityLeft,n=a;return(0,r.tZ)("span",{className:"wps-notice-text",css:[n,s.P6,";label:ProductBuyButtonTextNotice;"]},wp.i18n.sprintf(wp.i18n.__("Only %s left!","wpshopify"),t))}var l=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/common/utils/index.js"),c=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/common/variants/index.js"),p=n("../../../../../devil/devilbox-new/data/www/wpshopify-api/index.js"),w=n("../../../../../devil/devilbox-new/data/www/wpshopify-hooks/index.js"),u=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/lodash/unionBy.js"),v=n.n(u),f=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/lodash/has.js"),y=n.n(f),m=n("../../../../../devil/devilbox-new/data/www/wpshopify-components/node_modules/react-query/es/index.js");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var h=function(e){var t=e.payload,n=e.selectedVariant,r=e.isTouched,s=e.allOptionsSelected,a=wp.element,u=a.useEffect,f=a.useState,h=f(!1),x=(0,i.Z)(h,2),j=x[0],O=x[1],g=f("idle"),P=(0,i.Z)(g,2),S=P[0],k=P[1],N=f(!1),_=(0,i.Z)(N,2),I=_[0],B=_[1],E=(0,w.tm)();function J(e){return e&&e.variants?e.variants.map((function(e){return e.id})):[]}return(0,m.useQuery)("inventory-"+t.title,(function(){var e=J(t),n=(0,p.lJ)("wps-inventory-levels");if(e.length)return n&&(n=JSON.parse(n),!(e=(0,l.Xd)(n,e)).length)?(k("resolved"),B(n),Promise.resolve({data:n,cached:!0})):(0,p.$x)({ids:J(t)});console.warn("WP Shopify warning: No variant ids found for fetchVariantInventoryManagement")}),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({enabled:r&&"idle"===S,onError:function(e){k("error")},onSuccess:function(e){if(k("resolved"),!y()(e,"cached")){y()(e,"data")&&(e=e.data);var t=(0,p.lJ)("wps-inventory-levels");t=!!t&&JSON.parse(t);var n=function(e){if(y()(e,"data"))var t=e.data;else t=e;return t?t.map((function(e){return!!e&&{id:btoa(e.id),tracked:!!y()(e,"inventoryItem")&&e.inventoryItem.tracked,inventoryLevels:!!y()(e,"inventoryItem")&&e.inventoryItem.inventoryLevels,inventoryPolicy:e.inventoryPolicy}})):[]}(e),o=v()(n,t,"id");(0,p.K7)("wps-inventory-levels",JSON.stringify(o)),B(n)}}},p.li)),u((function(){if(E.current&&n){if(n.availableForSale){var e=(0,c.Qe)(I,n.id);e||O(!1),O(e)}}else O(!1)}),[n]),j&&s&&React.createElement(d,{quantityLeft:j})}}}]);